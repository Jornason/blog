<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Jekyll 筛选 tag 的实现 | TaoAlpha's Blog</title><meta name="description" content="Here is my new blog based on hexo."><meta name="viewport" content="width=device-width, initial-scale=1"><!-- open graph part--><meta property="og:image" content="http://taoalpha.me/images/newblog.jpg"><meta property="og:description" content="TaoAlpha's hexo Blog"><meta property="og:type" content="website"><link rel="short icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/default.css"></head><body class="blogpost"><aside class="home-menu"><nav class="home-icon-con upside"></nav><a href="/blog/" class="home-menu-icon brand active">涛</a><a href="/blog/tipme" class="home-menu-icon"><i class="fa fa-1x fa-gratipay"></i></a><a href="javascript:$('.searchbox').focus().css('border', '4px dashed #666');setTimeout(function(){$('.searchbox').focus().css('border', 'none').css('border-bottom', '1px solid #ccc')},1000);" class="home-menu-icon"><i class="fa fa-1x fa-search"></i></a><a href="/blog/puzzle" class="home-menu-icon"><i class="fa fa-1x fa-puzzle-piece"></i></a><a href="javascript:;" title="Contact Me" class="home-menu-icon follow">+</a><div class="home-contact"><a href="http://facebook.com/zzgary/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/facebook-32.png" alt="facebook"></a><a href="http://github.com/taoalpha/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/github-32.png" alt="github"></a><a href="http://taoalpha.me" target="something"><img src="https://cdn3.iconfinder.com/data/icons/colore-sociale/32/mewally_32x32.png" alt="portfolio"></a><a href="http://douban.com/people/129154019" target="something"><img src="http://img3.douban.com/favicon.ico" alt="douban"></a></div><nav class="home-icon-con downside"><a href="#contribution" class="home-menu-icon makecontribution"><i class="fa fa-pencil fa-1x"></i></a><a id="togglemusic" href="javascript:;" class="home-menu-icon"><i class="fa fa-music fa-1x"></i></a></nav><div id="musicbar"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="40" src=""></iframe></div></aside><div id="contribution" class="hide"><span class="close"></span><input id="sender_mail" type="email" placeholder="Give me your email"><textarea id="contributionContent" name="contribution" cols="30" rows="10" placeholder="Thanks for your contribution!  Now tell me what you want to say: feedback ? advice ? contributions ? Whatever you want ^_^.  I will look at it as soon as I receive it and reply you asap.  "></textarea><input id="sendToMe" type="submit"></div><article id="content"><section class="entry"><h1 class="entry-title"><a href="http://taoalpha.me/blog/2015/05/07/tech-jekyll-tips-2/" title="Jekyll 筛选 tag 的实现">Jekyll 筛选 tag 的实现</a></h1><div class="meta-top"><a href="http://taoalpha.me"><div style="display:inline-block;" class="avatar"><img src="https://avatars3.githubusercontent.com/u/4335753?v=3&amp;s=40" alt="100"></div><span>TaoAlpha</span></a><span>2015-05-07</span><span class="wordage">4917字</span><span class="readspeed">15 分钟读完</span></div><p>对于blog而言, 利用categories和tags的筛选是非常方便的, 而在jekyll部署的静态博客中也能轻松的实现这一点的. 本文(也即本博客)中效果主要模仿<a href="http://jianshu.com" target="_blank" rel="external">简书</a>.</p>
<h2 id="u5C55_u73B0categories_u4EE5_u53CAtags"><a href="#u5C55_u73B0categories_u4EE5_u53CAtags" class="headerlink" title="展现categories以及tags"></a>展现categories以及tags</h2><blockquote>
<p>首先我们需要设定了tags的post… 这样你的<code>site.tags</code>才会有数据~ 具体的tags设定方法可以参照 <a href="/blog/2015/05/07/tech-jekyll-tips-1/">心得(1)</a><br>接着就是如何展现tags数据了~ 以本文为例, 我总计有三个category, 因为要实现不同category下的tag只出现在自己的category页面下方, 所以在展现tags的时候需要做一个category的判定.</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;&#10;&#123;% assign tags = &#34;all&#34; %&#125;&#10;// &#35774;&#32622;&#21464;&#37327;, &#36825;&#37324;&#29992;all&#26469;&#34920;&#31034;&#40664;&#35748;&#30340;&#31532;&#19968;&#20010;tag, &#20195;&#34920;&#20840;&#37096;tags&#30340;&#24773;&#20917;&#10;&#123;% for post in site.posts %&#125;&#10;    // &#21462;&#25152;&#26377;&#30340;post&#20986;&#26469;&#36880;&#19968;&#21028;&#23450;, &#36825;&#37324;&#26410;&#26469;post&#24456;&#22810;&#30340;&#35805;, &#20250;&#36827;&#34892;&#25968;&#37327;&#38480;&#21046;, &#30446;&#21069;&#25968;&#37327;&#22826;&#23569;, &#23601;&#31961;&#30528;&#29992;&#21862;&#10;    &#123;% for tag in post.tags %&#125;&#10;        // &#21462;post&#33258;&#24049;&#30340;tags&#20986;&#26469;, &#36880;&#19968;&#36827;&#34892;&#21028;&#23450;&#26159;&#21542;&#24050;&#32463;&#22312;tags&#25968;&#32452;&#21015;&#34920;&#20013;&#20102;&#10;        &#123;% unless tags contains tag %&#125;&#10;            // &#20026;&#20102;&#21435;&#25481;&#37325;&#22797;&#30340;tag~&#10;            &#123;% capture tags %&#125;&#123;&#123; tags &#125;&#125;|&#123;&#123; tag &#125;&#125;&#123;% endcapture %&#125;&#10;            // &#25226;&#25152;&#26377;&#19981;&#22312;tags&#25968;&#32452;&#20013;&#30340;tag&#37117;&#21152;&#21040;tags&#20013;&#10;        &#123;% endunless %&#125;&#10;    &#123;% endfor %&#125;&#10;&#123;% endfor %&#125;&#10;&#123;% assign alltags = tags | split: &#39;|&#39; %&#125;&#10;// &#29983;&#25104;&#19968;&#20010;&#26032;&#30340;&#25968;&#32452;, &#20284;&#20046;&#26412;&#36523;liquid&#20013;&#27809;&#26377;&#30452;&#25509;append&#25968;&#32452;&#30340;&#26041;&#27861;... &#30475;&#21040;&#27492;&#22788;&#30340;&#26379;&#21451;&#26377;&#30693;&#36947;&#30340;&#35831;&#19981;&#21533;&#21578;&#30693;~&#10;&#60;ul class=&#34;tags&#34;&#62;&#10;&#123;% for tag in alltags %&#125;&#10;// &#23637;&#29616;tag&#10;&#60;a href=&#34;javascript:;&#34; data-rel=&#34;&#123;&#123; tag &#125;&#125;&#34; class=&#34;filter tag &#123;% if tag == &#39;all&#39;  %&#125;active&#123;% endif %&#125;&#34; &#62;&#123;&#123; tag &#125;&#125;&#60;/a&#62;&#10;// &#36825;&#37324;&#30340;data-rel&#26159;&#20026;&#20102;&#31579;&#36873;&#20570;&#30340;&#20934;&#22791;, &#21518;&#25991;&#20250;&#20171;&#32461;&#10;&#123;% endfor %&#125;&#10;&#60;/ul&#62;&#10;&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>
<p>如此基本就实现了tags在特定category下的展现.</p>
<h2 id="u6839_u636Etag_u8FDB_u884C_u7B5B_u9009"><a href="#u6839_u636Etag_u8FDB_u884C_u7B5B_u9009" class="headerlink" title="根据tag进行筛选"></a>根据tag进行筛选</h2><p>有了tags之后, 就可以进一步做筛选了. 基本的思路是在不考虑分页的情况下, 筛选基本就是针对当前展现出来的文章列表做对应的展现隐藏控制.</p>
<blockquote>
<p>利用<code>data-rel</code>(随意指定data后面的名称即可)存储要筛选的tag, 如上;<br>在post中加上tags的数据标签:</p>
</blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;&#10;&#60;li class=&#34;post&#34; data-filter=&#34;&#123;&#123; post.tags|join:&#39; &#39; &#125;&#125;&#34;&#62;&#10;// &#22240;&#20026;post.tags&#26412;&#36523;&#23601;&#26159;&#19968;&#20010;array&#31867;&#22411;, &#25152;&#20197;&#36825;&#37324;&#30452;&#25509;&#29992;&#31354;&#26684;&#38142;&#25509;&#22635;&#20837;&#19968;&#20010;`data-filter`&#20013;&#21363;&#21487;;&#10;&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>利用js实现点击筛选的控制:</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">".filter"</span>).on(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 由tag点击事件出发</span></span><br><span class="line">    <span class="keyword">var</span> $<span class="keyword">this</span> = $(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !$<span class="keyword">this</span>.hasClass(<span class="string">"active"</span>) ) &#123;</span><br><span class="line">        <span class="comment">// 排除当前已选tag, 新tag标记active</span></span><br><span class="line">        $(<span class="string">".filter"</span>).removeClass(<span class="string">"active"</span>);</span><br><span class="line">        $<span class="keyword">this</span>.addClass(<span class="string">"active"</span>); <span class="comment">// set the active tab</span></span><br><span class="line">        <span class="keyword">var</span> $filter = $<span class="keyword">this</span>.data(<span class="string">"rel"</span>); </span><br><span class="line">        <span class="comment">// 获得要筛选的tag名称</span></span><br><span class="line">        $filter == <span class="string">'all'</span> ? </span><br><span class="line">            <span class="comment">// 对all做单独判断, 基本就是全展现</span></span><br><span class="line">            $(<span class="string">".post"</span>)</span><br><span class="line">            .not(<span class="string">":visible"</span>)</span><br><span class="line">            .fadeIn() </span><br><span class="line">        : <span class="comment">// 否则的话, 利用filter进行tag匹配的判断</span></span><br><span class="line">            $(<span class="string">".post"</span>)</span><br><span class="line">            .fadeOut(<span class="number">0</span>)</span><br><span class="line">            .filter(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                <span class="comment">// 判断post中是否包含此tag, 这里用array来判断而不是直接文本判断就是为了防止出现类似tag和tags这种局部包含的误判</span></span><br><span class="line">                <span class="keyword">return</span> $(<span class="keyword">this</span>).data(<span class="string">"filter"</span>).split(<span class="string">" "</span>).indexOf($filter)!=-<span class="number">1</span>; </span><br><span class="line">            &#125;)</span><br><span class="line">            .fadeIn(<span class="number">1000</span>); </span><br><span class="line">    &#125; <span class="comment">// endif</span></span><br><span class="line">&#125;); <span class="comment">// endon</span></span><br></pre></td></tr></table></figure>
<p>这里都用的是fadeIn,fadeOut的动效, 你当然可以修改成自己的~ 这里的实现主要参照了<a href="http://www.jqueryrain.com/?http://www.picssel.com/demos/fboxfilteredgallery.html" target="_blank" rel="external">jQuery filter with fancybox</a>, 不过原理其实很简单的~</p>
<h2 id="tags_u9650_u5236"><a href="#tags_u9650_u5236" class="headerlink" title="tags限制"></a>tags限制</h2><p>随着post的增多, 你会发现自己的tags也越来越庞大, 如果全部展现的话, 一是太多, 二呢, 展现也不方便, 毕竟我目前的css样式只考虑了两行的情况, 所以呢, 还是需要对tags的展现做一些限制的.</p>
<p>有两种思路:</p>
<ul>
<li><p>利用jekyll的plugin直接在生成层控制, 每次随机出一些tag就行了;</p>
</li>
<li><p>利用js在展现层控制, 所有tag都生成出来, 但是由js控制随机展现一部分;</p>
</li>
</ul>
<p>最终我用的还是第二种思路, 第一种思路主要缺点是在编译生成的时候控制的话, 只有每次重新编译才会重新生成, 和我希望的访问随机需求不符合.</p>
<p>实现方法也很容易, 基本就是利用Math.random()来生成随机数即可.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randomTags</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> originArray = $(<span class="string">'ul.tags'</span>).find(<span class="string">'a.tag'</span>)</span><br><span class="line">    originArray.eq(<span class="number">0</span>).show();</span><br><span class="line">    <span class="comment">// 确保 all 每次都展现</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">var</span> index = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*originArray.length)+<span class="number">1</span></span><br><span class="line">        <span class="comment">// 没有做虑重处理, 所以很可能展现出来的tag没有10个; 想做的话也容易, 循环过程中加个是否显示了的判断即可, 这里就不做了~</span></span><br><span class="line">        originArray.eq(index).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上, 对于jekyll的tags和categories的探索就先这样了~ 以后有什么更加有趣的想法或者发现了再补充~</p>
<p>See ya.</p>
<aside class="tipme special"><a href="/blog/tipme" class="tipme">If you like my work, buy me a soda or send me a book ! ^_^</a></aside></section><aside class="sidenav"><input type="text" placeholder="Enter to search" class="st-default-search-input searchbox"></aside><div class="relatedposts sidenav"><h2>Related Posts:</h2><ul class="article-list"><li><a href="http://taoalpha.me/blog/2015/05/06/tech-startss-invitation-code/">Start SS邀请码抢码活动</a></li><li><a href="http://taoalpha.me/blog/2015/12/27/tech-related-articles-and-generate-api-files-in-hexo/">Related Articles and generate API files in Hexo</a></li><li><a href="http://taoalpha.me/blog/2015/09/30/tech-use-javascript-to-send-email/">Use only JavaScript to send email</a></li><li><a href="http://taoalpha.me/blog/2015/06/21/tech-add-internal-search-to-jekyll-blog/">自建倒排, 为 Jekyll 博客添加搜索功能</a></li><li><a href="http://taoalpha.me/blog/2015/06/07/tech-add-google-analytics-pageviews-to-jekyll-blog/">如何给 Jekyll 博文添加阅读数显示</a></li></ul></div><aside class="sidenav"><div class="recentposts"><h2>Recent Posts:</h2><ul class="article-list"><li><a href="http://taoalpha.me/blog/2016/01/04/oj-oj-leetcode-sort-1/">OJ LeetCode Sort 1</a></li><li><a href="http://taoalpha.me/blog/2015/12/26/Close-old-website-and-related-services/">Close old website and related services</a></li><li><a href="http://taoalpha.me/blog/2015/12/26/Summary-of-the-year/">Summary of the year</a></li><li><a href="http://taoalpha.me/blog/2015/12/26/blog-migration/">Blog Migration from jekyll to hexo</a></li><li><a href="http://taoalpha.me/blog/2015/12/07/tech-my-first-cli-tool-with-nodejs/">First CLI tool with NodeJS</a></li></ul></div></aside><div class="comments"><div data-thread-key="2015/05/07/tech-jekyll-tips-2/" data-title="Jekyll 筛选 tag 的实现" data-url="http://taoalpha.me/blog/2015/05/07/tech-jekyll-tips-2/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"taoalpha"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script></div></article><div class="notification fail hidden"></div><!-- jquery--><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46725017-2",'auto');ga('send','pageview');</script><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','CUMLELEvkSRAFuVehSCm','2.0.0');</script><!-- main functions--><script src="/blog/js/functions.js"></script><script src="/blog/js/default.js"></script><script src="/blog/js/post.js"></script></body></html>