<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Array Operation Cost in JavaScript | TaoAlpha's Blog</title><meta name="description" content="Here is my new blog based on hexo."><meta name="viewport" content="width=device-width, initial-scale=1"><!-- open graph part--><meta property="og:image" content="http://taoalpha.me/images/newblog.jpg"><meta property="og:description" content="TaoAlpha's hexo Blog"><meta property="og:type" content="website"><link rel="short icon" href="/blog/favicon.png"><link rel="stylesheet" href="/blog/css/default.css"></head><body class="blogpost"><aside class="home-menu"><nav class="home-icon-con upside"></nav><a href="/blog/" class="home-menu-icon brand active">涛</a><a href="/blog/tipme" class="home-menu-icon"><i class="fa fa-1x fa-gratipay"></i></a><a href="javascript:$('.searchbox').focus().css('border', '4px dashed #666');setTimeout(function(){$('.searchbox').focus().css('border', 'none').css('border-bottom', '1px solid #ccc')},1000);" class="home-menu-icon"><i class="fa fa-1x fa-search"></i></a><a href="/blog/puzzle" class="home-menu-icon"><i class="fa fa-1x fa-puzzle-piece"></i></a><a href="javascript:;" title="Contact Me" class="home-menu-icon follow">+</a><div class="home-contact"><a href="http://facebook.com/zzgary/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/facebook-32.png" alt="facebook"></a><a href="http://github.com/taoalpha/" target="something"><img src="https://cdn1.iconfinder.com/data/icons/social-shade-rounded-rects/512/github-32.png" alt="github"></a><a href="http://taoalpha.me" target="something"><img src="https://cdn3.iconfinder.com/data/icons/colore-sociale/32/mewally_32x32.png" alt="portfolio"></a><a href="http://douban.com/people/129154019" target="something"><img src="http://img3.douban.com/favicon.ico" alt="douban"></a></div><nav class="home-icon-con downside"><a href="#contribution" class="home-menu-icon makecontribution"><i class="fa fa-pencil fa-1x"></i></a><a id="togglemusic" href="javascript:;" class="home-menu-icon"><i class="fa fa-music fa-1x"></i></a></nav><div id="musicbar"><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="298" height="40" src=""></iframe></div></aside><div id="contribution" class="hide"><span class="close"></span><input id="sender_mail" type="email" placeholder="Give me your email"><textarea id="contributionContent" name="contribution" cols="30" rows="10" placeholder="Thanks for your contribution!  Now tell me what you want to say: feedback ? advice ? contributions ? Whatever you want ^_^.  I will look at it as soon as I receive it and reply you asap.  "></textarea><input id="sendToMe" type="submit"></div><article id="content"><section class="entry"><h1 class="entry-title"><a href="http://taoalpha.me/blog/2015/10/30/tech-javascript-array-operation-cost/" title="Array Operation Cost in JavaScript">Array Operation Cost in JavaScript</a></h1><div class="meta-top"><a href="http://taoalpha.me"><div style="display:inline-block;" class="avatar"><img src="https://avatars3.githubusercontent.com/u/4335753?v=3&amp;s=40" alt="100"></div><span>TaoAlpha</span></a><span>2015-10-30</span><span class="wordage">5300字</span><span class="readspeed">16 分钟读完</span></div><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p><code>concat()</code>,<code>splice()</code>,<code>slice()</code>,<code>push()</code>,<code>pop()</code>,<code>shift()</code>,<code>unshift()</code>… all these handy functions belong to Array. We are using them everyday, but do you really know about them ? Time cost of a function in language like JavaScript is not easy to measurement, since different browsers use different javascript engine which will cause different implementation on same functions. But, normally, the basic operations will be the same.</p>
<p>So today, I will test some basic array operations on NodeJS and compare the time cost between these operations.</p>
<p><strong>TEST ENVIRONMENT:</strong> Mac Air, iTerm, NodeJS v4.1.1</p>
<h2 id="Constructor"><a href="#Constructor" class="headerlink" title="Constructor"></a>Constructor</h2><p>We all know that we have several different ways to construct an array, the most frequently used are two methods I list below:</p>
<ul>
<li>Literal notation : <code>[ele1,ele2,...]</code></li>
<li><code>new</code> function : <code>new Array(ele1,ele2,...)</code> or <code>new Array(length_of_array)</code></li>
</ul>
<p>Normally there are no difference between these two methods. But if you are dealing with some real big datasets and you know exactly how long your array is and want to save a few time for some basic operations, you may should continue reading.</p>
<p>The fundamental difference between these two methods is : literal notation declare an array with elements in it, <code>new Array(ele1,ele2,...)</code> will do exactly the same, but <code>new Array(length_of_array)</code> will only declare a length of a array(and create or allocate a memory for this array with its length).</p>
<p>Here is a gif about the memory allocation will give you a clear understanding about it.</p>
<p><img src="https://gamealchemist.files.wordpress.com/2013/05/array.png" alt="bad allocate"></p>
<p>The advantage of declaring with allocating is that it can improve the speed of constructing an array.</p>
<p>As test I did, to construct a 100000 array with 0-99999 (average time cost):</p>
<ul>
<li>Use literal notation with push(): 8ms</li>
<li>Use literal notation with unshift(): 2230ms</li>
<li>Use literal notation with assigning directly by index: 5ms </li>
<li>Use <code>new Array(100000)</code> with assigning directly by index: 2ms</li>
<li>Use literal notation with assigning length first then assigning directly by index : 2ms</li>
</ul>
<p>Apparently, it would save you some time if you declare the length before you assign the values.And if you don’t like to use the <code>new</code>, you can still use literal notation and set the length manually.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// time cost for array constructing</span></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">0</span></span><br><span class="line"><span class="keyword">var</span> ar = []</span><br><span class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">100000</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">"Literal notation with assigning directly"</span>)</span><br><span class="line"><span class="keyword">while</span>(i&lt;=<span class="number">99999</span>)&#123;</span><br><span class="line">  ar[i] = i</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">"Literal notation with assigning directly"</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">ar = []</span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">"Literal notation with push()"</span>)</span><br><span class="line"><span class="keyword">while</span>(i&lt;=<span class="number">99999</span>)&#123;</span><br><span class="line">  ar.push(i)</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">"Literal notation with push()"</span>)</span><br><span class="line"></span><br><span class="line">ar = []</span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">"Literal notation with unshift()"</span>)</span><br><span class="line"><span class="keyword">while</span>(i&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">  ar.unshift(i)</span><br><span class="line">  i --</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">"Literal notation with unshift()"</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">ar = []</span><br><span class="line">ar.length = <span class="number">100000</span></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">"Literal notation with declaring length first"</span>)</span><br><span class="line"><span class="keyword">while</span>(i&lt;=<span class="number">99999</span>)&#123;</span><br><span class="line">  ar[i] = i</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">"Literal notation with declaring length first"</span>)</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="built_in">console</span>.time(<span class="string">"Using new with length defined"</span>)</span><br><span class="line"><span class="keyword">while</span>(i&lt;=<span class="number">99999</span>)&#123;</span><br><span class="line">  arr[i] = i</span><br><span class="line">  i++</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.timeEnd(<span class="string">"Using new with length defined"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="delete_and_remove"><a href="#delete_and_remove" class="headerlink" title="delete and remove"></a>delete and remove</h2><p>JavaScript does have a keyword for deleting: delete. For array, when you use <code>delete ar[i]</code>, you actually assign <code>ar[i] = undefined</code>. I recommend you to use the second method since it is a little faster.</p>
<p>Test on 100000-length list (delete all elements):</p>
<ul>
<li>Delete with “delete” keyword: 11ms</li>
<li>Delete with assigning “undefined” to the value: 2ms</li>
</ul>
<p>Both of the two methods would not change the length of the array, but we can also use “pop()”, “shift()” to empty an array.</p>
<p>Test on 100000-length list (remove all elements):</p>
<ul>
<li>remove with “pop()”: 5ms </li>
<li>remove with “shift()”: 18ms</li>
<li>remove with splice() : 25ms</li>
</ul>
<p>So, the shift() will cost near 3 times of pop() and splice() even slower. </p>
<p>Of course, under different conditions, you will choose different methods to achieve what you want.</p>
<h2 id="other_native_functions"><a href="#other_native_functions" class="headerlink" title="other native functions"></a>other native functions</h2><p>I did some tests on other basic native functions too. Here are the results:</p>
<ul>
<li>splice() to insert 1000 elements into a 100000-length list : 60ms </li>
<li>concat() two 100000-length lists : 1ms</li>
<li>Use while loop and push to concat two 100000-length lists : 8ms</li>
<li>slice() to hard copy one 100000-length list : 1ms</li>
<li>Use while loop and push to hard copy one 100000-length list : 8ms</li>
<li>Use while loop and assign value with predefined length to copy one 100000-length list : 2 (same as constructing part)</li>
<li>indexOf() to search every element in a 100000-length list (the smaller the index is, the sooner it will be): 4600ms </li>
<li>Use while loop to achieve the search : 7300ms</li>
<li>Reverse (ordered list like 0 - 99999) : 1ms</li>
<li>Reverse (ordered list like 99999 - 0) : 100ms (this is weird…)</li>
</ul>
<p>Most of time, the native functions are the best methods to do the operation since the engine already done a lot to optimize them.</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>Sometimes you will think these small difference between different methods is not important, since the technology is growing so fast, the difference will become so small that we can just ignore them. That’s 100% correct!</p>
<p>I did these just because I am curious and sometimes, if you are dealing with a really large dataset, then maybe the nanoseconds count and you may want to use some small changes to optimize your code. Why don’t you always keep your code optimized all the time?</p>
<p>That’s all!</p>
<aside class="tipme special"><a href="/blog/tipme" class="tipme">If you like my work, buy me a soda or send me a book ! ^_^</a></aside></section><aside class="sidenav"><input type="text" placeholder="Enter to search" class="st-default-search-input searchbox"></aside><aside class="sidenav series"><h2>In Serie: JavaScript Performance<i class="fa fa-arrow-down expand"></i><i class="collapse fa fa-arrow-up"></i></h2><ul class="article-list"><li><a href="http://taoalpha.me/blog/2015/10/30/tech-javascript-array-operation-cost/" data-id='null' class="current">Array Operation Cost in JavaScript</a></li></ul></aside><aside class="sidenav"><div class="recentposts"><h2>Recent Posts:</h2><ul class="article-list"></ul><li><a href="http://taoalpha.me/blog/2015/12/26/Close-old-website-and-related-services/">Close old website and related services</a></li><li><a href="http://taoalpha.me/blog/2015/12/26/Summary-of-the-year/">Summary of the year</a></li><li><a href="http://taoalpha.me/blog/2015/12/26/blog-migration/">Blog Migration from jekyll to hexo</a></li><li><a href="http://taoalpha.me/blog/2015/12/07/tech-my-first-cli-tool-with-nodejs/">First CLI tool with NodeJS</a></li><li><a href="http://taoalpha.me/blog/2015/11/27/thanksgiving/">感恩</a></li><li><a href="http://taoalpha.me/blog/2015/11/19/tech-preventDefault-and-stopPropagation-in-JS/">preventDefault and stopPropagation in JS</a></li></div></aside><div class="comments"><div data-thread-key="2015/10/30/tech-javascript-array-operation-cost/" data-title="Array Operation Cost in JavaScript" data-url="http://taoalpha.me/blog/2015/10/30/tech-javascript-array-operation-cost/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"taoalpha"};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
   || document.getElementsByTagName('body')[0]).appendChild(ds);
})();
</script></div></article><div class="notification fail hidden"></div><!-- jquery--><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-46725017-2",'auto');ga('send','pageview');</script><script>(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');
_st('install','CUMLELEvkSRAFuVehSCm','2.0.0');</script><!-- main functions--><script src="/blog/js/functions.js"></script><script src="/blog/js/default.js"></script><script src="/blog/js/post.js"></script></body></html>