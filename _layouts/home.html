{% include header.html %}
<body>
  {% include lsidebar.html pname=page.pname %}
  {% include aside.html %}

  <section class="index-content blog">
    <nav>
      <ul class="article-cate">
        <li {% if page.pname == 'blog' %}class="on"{% endif %}><a href="{{ site.baseurl }}"><span>All</span></a></li>
        <li {% if page.pname == 'tech' %}class="on"{% endif %}><a href="{{ site.baseurl }}/tech"><span>Tech</span></a></li>
        <li {% if page.pname == 'dandp' %}class="on"{% endif %}><a href="{{ site.baseurl }}/dandp"><span>D&amp;P</span></a></li>
      </ul>
    </nav>

    <nav class="cate-bar">
      {% assign tags = "all" %}
      {% assign cposts = site.categories[page.pname] %}
      {% if page.pname == 'blog' %}
        {% assign cposts = site.posts %}
      {% endif %}
      {% for post in cposts %}
        {% for tag in post.tags %}
          {% unless tags contains tag %}
            {% capture tags %}{{ tags }}|{{ tag }}{% endcapture %}
          {% endunless %}
        {% endfor %}
      {% endfor %}
      {% assign alltags = tags | split: '|' %}
      <ul class="tags">
      {% for tag in alltags %}
          <a href="javascript:;" data-rel="{{ tag }}" class="filter tag {% if tag == 'all'  %}active{% endif %}" >{{ tag|replace:"-"," " }}</a>
      {% endfor %}
      </ul>
    </nav>

    <article>
      <ul class="article-list">
        {% for post in cposts %}
        <li class="post" data-filter="{{ post.tags|join:' ' }}">
          <h2><a href="{{ site.baseurl }}{{ post.url }}">{{ post.title }}</a></h2>
          <div class="title-excerpt">{{ post.content | strip_html | truncatewords:20 | markdownify }}</div>
          <div class="post-info">
            <span class="author"><i class="fa fa-user"></i>{{ post.author }}</span>
            <span class="category"><i class="fa fa-briefcase"></i>{{ post.category }}</span>
            <span class="tags"><i class="fa fa-tags"></i>{{ post.tags|join:" " }}</span>
            <span class="readspeed"><i class="fa fa-clock-o"></i>{{ post.content | strip_html | strip_newlines | size | divided_by:350 | round}} 分钟读完 </span>
          </div>
        </li>
        {% endfor %}
      </ul>
    </article>

  </section>


  <script type="text/javascript">
    getLocation()
    randomTags("")
  </script>

  {% javascript home %}
</body>
</html>


